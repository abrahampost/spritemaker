(this.webpackJsonpspritemaker=this.webpackJsonpspritemaker||[]).push([[0],[,,,,,function(e,t,a){e.exports={Tools:"Tools_Tools__2ZYfY",Tool:"Tools_Tool__3-sZp",Icon:"Tools_Icon__2qn5A",Active:"Tools_Active__2AX5m",Special:"Tools_Special__3sl6a",ColorPicker:"Tools_ColorPicker__2inf-",Undoable:"Tools_Undoable__3x95j",Disabled:"Tools_Disabled__1d70h"}},function(e,t,a){e.exports={TopBar:"TopBar_TopBar__1_vlW",MenuItem:"TopBar_MenuItem__1pCHd",SubMenu:"TopBar_SubMenu__3Q45P",SubMenuItem:"TopBar_SubMenuItem__JI3Pc",Label:"TopBar_Label__3taPn",Alt:"TopBar_Alt__GKwd_",Disabled:"TopBar_Disabled__3NYd8",SubMenuFileBrowserItem:"TopBar_SubMenuFileBrowserItem__IoW2T",Open:"TopBar_Open__ZmvHQ"}},function(e,t,a){e.exports={Backdrop:"Modal_Backdrop__2FiRk",Show:"Modal_Show__2jukh",Modal:"Modal_Modal__32mLz",Title:"Modal_Title__2bVOV",Body:"Modal_Body__iDczr"}},function(e,t,a){e.exports={Layout:"Layout_Layout__1RN_R",Tools:"Layout_Tools__2KsU7",Main:"Layout_Main__3C81A",Layers:"Layout_Layers__38RkV"}},function(e,t,a){e.exports={Canvas:"Canvas_Canvas__1VPYJ",Painting:"Canvas_Painting__MTXxZ",Filling:"Canvas_Filling__qc5Hk",Selecting:"Canvas_Selecting__gRcHX",Sampling:"Canvas_Sampling__1Rdgc"}},,,,,,function(e,t,a){e.exports={ExportModal:"ExportModal_ExportModal__2dsaN",Close:"ExportModal_Close__2scG4"}},,,,,,function(e,t,a){e.exports={CanvasController:"CanvasController_CanvasController__2EeQ0",Buttons:"CanvasController_Buttons__1Fp6i"}},function(e,t,a){e.exports={Preview:"Preview_Preview__2YDmj"}},function(e,t,a){e.exports=a(32)},,,,,function(e,t,a){},function(e,t,a){},,,function(e,t,a){"use strict";a.r(t);var n,o,l=a(1),c=a.n(l),r=a(17),i=a.n(r),s=(a(28),a(29),a(5)),u=a.n(s),d=a(12),f=a.n(d),E=a(20),v=a(19),h=a(14),p=a(18),_=a(3),m=a(2),O=a(4);!function(e){e[e.PAINT=0]="PAINT",e[e.FILL=1]="FILL",e[e.SELECT=2]="SELECT",e[e.SAMPLE=3]="SAMPLE"}(n||(n={})),function(e){e[e.NEW_FILE=0]="NEW_FILE",e[e.IMPORT_FILE=1]="IMPORT_FILE",e[e.EXPORT_FILE=2]="EXPORT_FILE",e[e.SET_CELL=3]="SET_CELL",e[e.FLOOD_FILL=4]="FLOOD_FILL",e[e.SET_SELECTION=5]="SET_SELECTION",e[e.FILL_SELECTION=6]="FILL_SELECTION",e[e.SAMPLE_CELL=7]="SAMPLE_CELL",e[e.ADD_HISTORY=8]="ADD_HISTORY",e[e.UNDO_HISTORY=9]="UNDO_HISTORY",e[e.REDO_HISTORY=10]="REDO_HISTORY",e[e.SELECT_TOOL=11]="SELECT_TOOL",e[e.CHANGE_COLOR=12]="CHANGE_COLOR",e[e.SET_PREVIEW_CANVAS=13]="SET_PREVIEW_CANVAS"}(o||(o={}));var b={width:16,height:16,undoStack:[],redoStack:[],cells:Object(O.a)(Array(256).fill("#ffffff")),previousTool:null,selectedTool:n.PAINT,activeColor:"#000000",selection:null,previewCanvas:null},T=Object(l.createContext)({state:b,dispatch:function(e){e.type,e.payload}}),S=function(e,t){var a=t.type,l=t.payload;switch(a){case o.NEW_FILE:return window.confirm("You will lose all unsaved changes if you do this. This is not undoable. Continue?")?Object(m.a)({},b):e;case o.EXPORT_FILE:var c,r,i=l.fileType,s=l.fileName,u=document.createElement("a");if("png"===i){var d;if(!(r=null===(d=e.previewCanvas)||void 0===d?void 0:d.toDataURL("image/png")))return alert("Unable to convert "),e;u.href=r,u.setAttribute("download",s+".png")}else r=e.cells.map((function(e){return e.substring(1,2)+e.substring(3,4)+e.substring(5,6)})).join("\n"),u.href="data:,"+encodeURIComponent(r),u.setAttribute("download",s+".bmp541");return u.click(),null===(c=u.parentNode)||void 0===c||c.removeChild(u),e;case o.IMPORT_FILE:var f=l.split("\n");if(f.length!==e.width*e.height)return alert("Wrong number of lines: received ".concat(f.length,", expected: ").concat(e.width*e.height)),e;var E=f.map((function(e){return["#",e.charAt(0)+e.charAt(0)+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2)].join("")}));return Object(m.a)(Object(m.a)({},e),{},{cells:E});case o.SET_CELL:var v=l.x,h=l.y,p=l.color,_=Object(O.a)(e.cells);return _[h*e.width+v]=p,Object(m.a)(Object(m.a)({},e),{},{cells:_});case o.FLOOD_FILL:var T=l.x,S=l.y,L=l.color,C=e.cells[S*e.width+T],y=Object(O.a)(e.cells);if(C===L)return e;return function t(a,n,o,l){a<0||a>=e.width||n<0||n>=e.height||e.cells[n*e.width+a]!==o||y[n*e.width+a]===l||(y[n*e.width+a]=l,t(a,n+1,o,l),t(a-1,n,o,l),t(a+1,n,o,l),t(a,n-1,o,l))}(T,S,C,L),Object(m.a)(Object(m.a)({},e),{},{cells:y});case o.SET_SELECTION:return Object(m.a)(Object(m.a)({},e),{},{selection:l});case o.FILL_SELECTION:if(!e.selection)return e;for(var g=Object(O.a)(e.cells),j=e.selection.y;j<=e.selection.y+e.selection.height;j++)for(var w=e.selection.x;w<=e.selection.x+e.selection.width;w++){g[j*e.width+w]=e.activeColor}return Object(m.a)(Object(m.a)({},e),{},{cells:g});case o.ADD_HISTORY:var I=[].concat(Object(O.a)(e.undoStack),[Object(O.a)(e.cells)]);return I.length>20&&I.shift(),Object(m.a)(Object(m.a)({},e),{},{undoStack:I,redoStack:[]});case o.UNDO_HISTORY:if(0===e.undoStack.length)return e;var k=[Object(O.a)(e.cells)].concat(Object(O.a)(e.redoStack)),N=Object(O.a)(e.undoStack),M=N.pop()||Object(O.a)(Array(e.width*e.height).fill("#ffffff"));return Object(m.a)(Object(m.a)({},e),{},{cells:Object(O.a)(M),undoStack:N,redoStack:k});case o.REDO_HISTORY:if(0===e.redoStack.length)return e;var A=Object(O.a)(e.redoStack),x=[].concat(Object(O.a)(e.undoStack),[Object(O.a)(e.cells)]),R=A.shift()||Object(O.a)(Array(e.width*e.height).fill("#ffffff"));return Object(m.a)(Object(m.a)({},e),{},{cells:Object(O.a)(R),undoStack:x,redoStack:A});case o.SAMPLE_CELL:var P=l.x,F=l.y,D=e.cells[F*e.width+P];return Object(m.a)(Object(m.a)({},e),{},{activeColor:D,selectedTool:e.previousTool||n.PAINT,previousTool:null});case o.SELECT_TOOL:return Object(m.a)(Object(m.a)({},e),{},{previousTool:e.selectedTool,selectedTool:l});case o.CHANGE_COLOR:return Object(m.a)(Object(m.a)({},e),{},{activeColor:l});case o.SET_PREVIEW_CANVAS:return Object(m.a)(Object(m.a)({},e),{},{previewCanvas:l});default:return e}},L=function(e){var t=e.children,a=Object(l.useReducer)(S,b),n=Object(_.a)(a,2),o=n[0],r=n[1];return c.a.createElement(T.Provider,{value:{state:o,dispatch:r}},t)},C=[{type:n.PAINT,icon:h.a},{type:n.FILL,icon:p.a},{type:n.SELECT,icon:v.a},{type:n.SAMPLE,icon:E.a}],y=function(e){var t=e.id,a=e.active,n=e.Icon,o=e.clicked;return c.a.createElement("div",{key:t,className:[u.a.Tool,a?u.a.Active:null].join(" "),onClick:o},c.a.createElement(n,{className:u.a.Icon}))},g=function(){var e=Object(l.useContext)(T),t=e.state,a=e.dispatch,n=Object(l.useCallback)(f.a.throttle((function(e){a({type:o.CHANGE_COLOR,payload:e.target.value})}),25,{leading:!0,trailing:!1}),[]),r=C.map((function(e,n){return c.a.createElement(y,{id:n,active:t.selectedTool===n,Icon:e.icon,key:n,clicked:function(){return t=e.type,a({type:o.SELECT_TOOL,payload:t});var t}})}));return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:u.a.Tools},r),c.a.createElement("div",{className:u.a.Special},c.a.createElement("p",null,t.activeColor),c.a.createElement("input",{className:u.a.ColorPicker,type:"color",value:t.activeColor,onChange:function(e){e.persist(),n(e)}}),c.a.createElement("div",{className:u.a.Undoable},c.a.createElement(h.c,{className:t.undoStack.length>0?"":u.a.Disabled,onClick:function(){return a({type:o.UNDO_HISTORY,payload:null})}}),c.a.createElement(h.b,{className:t.redoStack.length>0?"":u.a.Disabled,onClick:function(){return a({type:o.REDO_HISTORY,payload:null})}}))))},j=a(8),w=a.n(j),I=a(21),k=a.n(I),N=a(11),M=a.n(N),A=a(9),x=a.n(A),R=function(e){var t=e.mouseDown,a=e.mouseUp,o=e.drag,r=Object(l.createRef)(),i=Object(l.useState)(null),s=Object(_.a)(i,2),u=s[0],d=s[1],f=Object(l.useState)({x:512,y:512}),E=Object(_.a)(f,2),v=E[0],h=E[1],p=Object(l.useState)(32),m=Object(_.a)(p,2),O=m[0],b=m[1],S=Object(l.useState)(!1),L=Object(_.a)(S,2),C=L[0],y=L[1],g=Object(l.useContext)(T).state;Object(l.useEffect)((function(){var e;r&&d((null===(e=r.current)||void 0===e?void 0:e.getContext("2d"))||null)}),[r]),Object(l.useEffect)((function(){var e=function(){return y(!1)};C?document.addEventListener("click",e):document.removeEventListener("click",e)}),[C]),Object(l.useEffect)((function(){g.width>g.height?(h({x:512,y:Math.round(g.height/g.width*512)}),b(512/g.width)):g.height>g.width?(h({x:Math.round(g.width/g.height*512),y:512}),b(512/g.height)):(h({x:512,y:512}),b(512/g.width))}),[g.width,g.height]),Object(l.useEffect)((function(){if(u){u.fillStyle="#000000",u.fillRect(0,0,v.x,v.y);for(var e=0;e<g.height;e++)for(var t=0;t<g.width;t++)u.fillStyle=g.cells[e*g.width+t],u.fillRect(t*O,e*O,O-1,O-1);null!=g.selection&&(u.lineWidth=5,u.fillStyle="#0000ff88",u.fillRect(g.selection.x*O-1,g.selection.y*O-1,(g.selection.width+1)*O+1,(g.selection.height+1)*O+1),u.lineWidth=1),u.strokeStyle="#333333";for(var a=1;a<g.width;a++)u.moveTo(O*a,0),u.lineTo(O*a,v.y),u.stroke();for(var n=1;n<g.height;n++)u.moveTo(0,O*n),u.lineTo(v.x,O*n),u.stroke()}}),[u,O,v,g.width,g.height,g.cells,g.selection]);return c.a.createElement("canvas",{className:M()(x.a.Canvas,g.selectedTool===n.SELECT&&x.a.Selecting,g.selectedTool===n.FILL&&x.a.Filling,g.selectedTool===n.PAINT&&x.a.Painting,g.selectedTool===n.SAMPLE&&x.a.Sampling),ref:r,width:v.x,height:v.y,onMouseMove:function(e){if(C){var t=0+e.nativeEvent.offsetX,a=0+e.nativeEvent.offsetY,n=Math.floor(t/O),l=Math.floor(a/O);o(n,l)}},onMouseDown:function(e){var a=0+e.nativeEvent.offsetX,n=0+e.nativeEvent.offsetY,o=Math.floor(a/O),l=Math.floor(n/O);t(o,l),y(!0)},onMouseUp:function(e){var t=0+e.nativeEvent.offsetX,n=0+e.nativeEvent.offsetY,o=Math.floor(t/O),l=Math.floor(n/O);a(o,l),y(!1)}})},P=function(){var e=Object(l.useContext)(T),t=e.state,a=e.dispatch,r=Object(l.useState)({x:0,y:0}),i=Object(_.a)(r,2),s=i[0],u=i[1],f=function(e,n,l){e<0||e>=t.width||n<0||n>=t.height||t.cells[n*t.width+e]!==l&&a({type:o.SET_CELL,payload:{x:e,y:n,color:t.activeColor}})},E=function(){return a({type:o.ADD_HISTORY,payload:null})},v=Object(l.useCallback)(d.throttle((function(e,t){return function(e,t){var n=Math.min(s.x,e),l=Math.max(s.x,e),c=Math.min(s.y,t),r=Math.max(s.y,t);a({type:o.SET_SELECTION,payload:{x:n,y:c,width:l-n,height:r-c}})}(e,t)}),100),[s]),h=function(e,a){return!!t.selection&&(e>=t.selection.x&&e<=t.selection.x+t.selection.width&&a>=t.selection.y&&a<=t.selection.y+t.selection.height)};return c.a.createElement("div",{className:k.a.CanvasController},c.a.createElement(R,{mouseDown:function(e,l){switch(t.selectedTool){case n.PAINT:E(),f(e,l,t.activeColor);break;case n.FILL:E(),h(e,l)?a({type:o.FILL_SELECTION,payload:null}):a({type:o.FLOOD_FILL,payload:{x:e,y:l,color:t.activeColor}});break;case n.SAMPLE:a({type:o.SAMPLE_CELL,payload:{x:e,y:l}});break;case n.SELECT:u({x:e,y:l})}a({type:o.SET_SELECTION,payload:null})},mouseUp:function(e,t){},drag:function(e,a){t.selectedTool===n.PAINT?f(e,a,t.activeColor):t.selectedTool===n.SELECT&&v(e,a)}}))},F=a(22),D=a.n(F),B=function(){var e=Object(l.useContext)(T),t=e.state,a=e.dispatch,n=Object(l.useRef)(null),r=Object(l.useState)(),i=Object(_.a)(r,2),s=i[0],u=i[1];return Object(l.useEffect)((function(){var e;n&&(u((null===(e=n.current)||void 0===e?void 0:e.getContext("2d"))||void 0),a({type:o.SET_PREVIEW_CANVAS,payload:n.current}))}),[n,a]),Object(l.useEffect)((function(){if(s)for(var e=64/t.width,a=0;a<t.height;a++)for(var n=0;n<t.width;n++)s.fillStyle=t.cells[a*t.width+n],s.fillRect(n*e,a*e,e,e)}),[n,s,t.width,t.height,t.cells]),c.a.createElement("div",{className:D.a.Preview},c.a.createElement("p",null,"Preview"),c.a.createElement("canvas",{width:"64",height:"64",ref:n}))},Y=function(){return c.a.createElement("div",{className:w.a.Layout},c.a.createElement("div",{className:w.a.Tools},c.a.createElement(g,null),c.a.createElement(B,null)),c.a.createElement("div",{className:w.a.Main},c.a.createElement(P,null),c.a.createElement("div",{className:w.a.Frames})),c.a.createElement("div",{className:w.a.Layers}))},H=a(6),U=a.n(H),W=a(15),V=a.n(W),X=a(7),G=a.n(X),K=function(e){var t=e.show,a=e.close,n=e.title,o=e.children;return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:[G.a.Backdrop,t?G.a.Show:""].join(" "),onClick:a}),c.a.createElement("div",{className:[G.a.Modal,t?G.a.Show:""].join(" ")},c.a.createElement("div",{className:G.a.Title},n),c.a.createElement("div",{className:G.a.Body},o)))},Z=function(e){var t=e.show,a=e.close,n=Object(l.useContext)(T).dispatch,r=Object(l.useState)("bmp"),i=Object(_.a)(r,2),s=i[0],u=i[1],d=Object(l.useState)("MyImage"),f=Object(_.a)(d,2),E=f[0],v=f[1];return c.a.createElement(K,{show:t,title:"Export",close:a},c.a.createElement("form",{className:V.a.ExportModal,noValidate:!0,autoComplete:"off"},c.a.createElement("div",null,c.a.createElement("label",null,"File Name:"),c.a.createElement("input",{type:"text",onChange:function(e){v(e.target.value)},placeholder:"My_Save"})),c.a.createElement("select",{value:s,onChange:function(e){return u(e.target.value)}},c.a.createElement("option",{value:"bmp"},"541 BMP"),c.a.createElement("option",{value:"png"},"PNG")),c.a.createElement("button",{onClick:function(){n({type:o.EXPORT_FILE,payload:{fileType:s,fileName:E}})}},"Export as ",s.toUpperCase())),c.a.createElement("div",{className:V.a.Close},c.a.createElement("button",{onClick:a},"Close")))},z=function(e){var t=e.dispatch;return c.a.createElement("div",{className:U.a.SubMenuFileBrowserItem},c.a.createElement("input",{type:"file",accept:".bmp541,.dat",onChange:function(e){var a;if(0!==(null===(a=e.target.files)||void 0===a?void 0:a.length)){var n=new FileReader;n.readAsText(e.target.files[0]),n.onload=function(){t({type:o.IMPORT_FILE,payload:n.result})},n.onerror=function(e){return console.error(e)}}},value:""}),c.a.createElement("label",null,"Import"))},J=function(e){var t=e.label,a=e.alt,n=e.onClick,o=e.disabled;return c.a.createElement("div",{className:M()(U.a.SubMenuItem,o&&U.a.Disabled),onClick:n},c.a.createElement("span",{className:U.a.Label},t),c.a.createElement("span",{className:U.a.Alt},a))},Q=function(e){var t=e.label,a=e.isOpen,n=e.open,o=e.children;return c.a.createElement("div",{className:U.a.MenuItem},c.a.createElement("label",{onClick:n},t),c.a.createElement("div",{className:M()(U.a.SubMenu,a&&U.a.Open)},o))},q=function(){var e=Object(l.useContext)(T),t=e.state,a=e.dispatch,n=Object(l.useState)(null),r=Object(_.a)(n,2),i=r[0],s=r[1],u=function(){return s(null)},d=Object(l.useState)(!1),f=Object(_.a)(d,2),E=f[0],v=f[1];return Object(l.useEffect)((function(){return null!==i?document.addEventListener("click",u):document.removeEventListener("click",u),function(){return document.removeEventListener("click",u)}}),[i]),c.a.createElement("div",{className:U.a.TopBar},c.a.createElement(Z,{show:E,close:function(){return v(!1)}}),c.a.createElement(Q,{label:"File",open:function(){return s(1)},isOpen:1===i},c.a.createElement(J,{label:"New File",onClick:function(){return a({type:o.NEW_FILE,payload:null})}}),c.a.createElement(z,{dispatch:a}),c.a.createElement(J,{label:"Export",onClick:function(){return v(!0)}})),c.a.createElement(Q,{label:"Edit",open:function(){return s(2)},isOpen:2===i},c.a.createElement(J,{label:"Undo",alt:"ctrl + z",onClick:function(){a({type:o.UNDO_HISTORY,payload:null})},disabled:0===t.undoStack.length}),c.a.createElement(J,{label:"Redo",alt:"ctrl + shift + z",onClick:function(){a({type:o.REDO_HISTORY,payload:null})},disabled:0===t.redoStack.length})))},$=function(e){var t=e.children,a=Object(l.useContext)(T).dispatch,n=function(e){e.ctrlKey&&"KeyZ"===e.code&&(e.shiftKey?(e.preventDefault(),a({type:o.REDO_HISTORY,payload:null})):(e.preventDefault(),a({type:o.UNDO_HISTORY,payload:null})))};return Object(l.useEffect)((function(){return document.addEventListener("keypress",n),function(){document.removeEventListener("keypress",n)}})),c.a.createElement(c.a.Fragment,null,t)};var ee=function(){return c.a.createElement("div",null,c.a.createElement(L,null,c.a.createElement($,null,c.a.createElement("header",null,c.a.createElement(q,null)),c.a.createElement(Y,null))))},te=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ae(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}i.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(ee,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/spritemaker",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/spritemaker","/service-worker.js");te?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):ae(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):ae(t,e)}))}}()}],[[23,1,2]]]);
//# sourceMappingURL=main.1c336f44.chunk.js.map